#!/bin/sh -e

kubectl="kubectl --context=$HUB_DOMAIN_NAME --namespace=$NAMESPACE"

if test -n "$AZURE_STORAGE_ACCOUNT_NAME" && test -n "$BUCKET_NAME"; then
  color e <<END
Error conflicting configuration
You cannot use both S3 compatible and Azure Storage Account
END
  exit 1
elif test -z "$AZURE_STORAGE_ACCOUNT_NAME" && test -z "$BUCKET_NAME"; then
  color e <<END
Error: artivact store is not configured

Please set either AZURE_STORAGE_ACCOUNT_NAME or BUCKET_NAME
END
  exit 1
fi

$kubectl apply -f "resources/"
